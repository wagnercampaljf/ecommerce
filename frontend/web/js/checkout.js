$(document).ready(function(){/*$("#formpagamento-ccnumber").mask("0000.0000.0000.0000",{placeholder:"xxxx.xxxx.xxxx.xxxx"});$("#formpagamento-cvcnumber").mask("0000",{placeholder:"xxx"});$("#formpagamento-expirationdate").mask("00/00",{placeholder:"mm/aa"});*/$(".resultado-frete").each(function(){var a=$(this);$.ajax({type:"GET",url:baseUrl+"/checkout/get-frete",data:{cep:a.data("cep"),filial_id:a.data("filial-id"),returnType:"html"},success:function(b){a.fadeOut("300",function(){a.html(b);a.fadeIn("300",function(){frete_selecionado=$("#frete_selecionado_"+a.data("filial-id")).val();if(frete_selecionado){$radio=$(".radio_frete[data-filial-id="+a.data("filial-id")+'][value="'+frete_selecionado+'"]');$radio.attr("checked",true);changeValor($radio)}})})},beforeSend:function(b){string=a.data("cep");data=string.replace("-","").replace("_","");if((data).length!=8){return false}}})});$("button[type=button]").click(function(){if($(this).attr("id")=="btn-moip"){if($(".moip-fieldset").length==$(".moip-fieldset.hide").length){taxaMoip(0.69)}}else{taxaMoip(-0.69)}$("#forma_pagamento").val($(this).data("forma-pagamento"));$("button").attr("disabled",false);$(this).attr("disabled",true);id=$(this).data("forma-pagamento");$("fieldset").addClass("hide");$("#"+id).removeClass("hide");$(".panel-footer").removeClass("hide")});$("#checkout-form").submit(function(){$("#formpagamento-ccnumber").unmask()})});function taxaMoip(a){valorTotal=0;$(".total-filial").each(function(){valorPedido=parseFloat($(this).html().split("$").pop().replace(",","."))+a;valorTotal+=valorPedido;valorPedido="R$"+valorPedido.toFixed(2);$(this).html(valorPedido.replace(".",","));valorPedido=$(this).data("valorTotal")+a;$(this).data("valorTotal",valorPedido)});$("#valorTotal").html("R$"+valorTotal.toFixed(2).replace(".",","));atualizaTotal()}function changeValor(a){filial_id=a.data("filial-id");valorTotal=$("#valorTotal_"+filial_id).data("valor-total")+a.data("valor");$("#valorTotal_"+filial_id).html("R$ "+valorTotal.toFixed(2).replace(".",","));$("#pedido-"+filial_id+"-transportadora_id").val(a.data("transportadora-id"));$("#pedido-"+filial_id+"-data_prevista").val(a.data("prevista"));atualizaTotal()}function atualizaTotal(){valorTotal=0;arrayValores=[];$(".total-filial").each(function(){valorTotal+=parseFloat($(this).html().split("$").pop().replace(",","."));arrayValores.push(parseFloat($(this).html().split("$").pop().replace(",",".")))});$("#valorTotal").html("R$"+valorTotal.toFixed(2).replace(".",","));$.ajax({type:"GET",url:baseUrl+"/checkout/get-parcelas",data:{valor:valorTotal.toFixed(2),valores:arrayValores},success:function(a){$("#nrParcelas").html(a);$("#nrParcelas").select2()}})};
